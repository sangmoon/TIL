<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="자바 잘 짜보자">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="Effective Java">
<meta property="og:description" content="자바 잘 짜보자">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sangmoon.github.io/TIL/effectivejava/lambdasandstreams/"><meta property="article:section" content="EffectiveJava">
<meta property="article:published_time" content="2021-10-23T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-23T00:00:00+00:00">
<title>Effective Java | Sangmoon's TIL</title>
<link rel=manifest href=/TIL/manifest.json>
<link rel=icon href=/TIL/favicon.png type=image/x-icon>
<link rel=stylesheet href=/TIL/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous>
<script defer src=/TIL/flexsearch.min.js></script>
<script defer src=/TIL/en.search.min.58e317a58bdb983ff9fe64dbce44994883782a83ea5a5d5fbf080e12279c4e0f.js integrity="sha256-WOMXpYvbmD/5/mTbzkSZSIN4KoPqWl1fvwgOEiecTg8=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/TIL/><span>Sangmoon's TIL</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/TIL/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Effective Java</strong>
<label for=toc-control>
<img src=/TIL/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#규칙-42-익명-클래스-보다-람다를-쓰자>규칙 42 익명 클래스 보다 람다를 쓰자</a>
<ul>
<li><a href=#람다의-특징>람다의 특징</a></li>
<li><a href=#주의할-점>주의할 점</a></li>
<li><a href=#익명-클래스가-람다보다-좋은-점>익명 클래스가 람다보다 좋은 점</a></li>
<li><a href=#요약>요약</a></li>
</ul>
</li>
<li><a href=#규칙-43-람다보다-메소드-참조를-쓰자>규칙 43 람다보다 메소드 참조를 쓰자</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=chapter-7-lambdas-and-streams>
Chapter 7 Lambdas and Streams
<a class=anchor href=#chapter-7-lambdas-and-streams>#</a>
</h1>
<p>자바8에 함수형 인터페이스, 람다 메서드 참조 등이 추가됨.
Stream API 또한 추가되어서 이러한 언어변화에 맞는 데이터 요소 처리를 돕는다.</p>
<h2 id=규칙-42-익명-클래스-보다-람다를-쓰자>
규칙 42 익명 클래스 보다 람다를 쓰자
<a class=anchor href=#%ea%b7%9c%ec%b9%99-42-%ec%9d%b5%eb%aa%85-%ed%81%b4%eb%9e%98%ec%8a%a4-%eb%b3%b4%eb%8b%a4-%eb%9e%8c%eb%8b%a4%eb%a5%bc-%ec%93%b0%ec%9e%90>#</a>
</h2>
<p>오래전부터 1개의 추상 메소드를 갖는 인터페이스는 function type 으로 쓰여옴.
이 인터페이스를 구현한 <code>function objects</code> 는 함수를 나타냄.
JDK1.1 부터 함수 객체를 만드는 가장 대표적인 수단은 익명 클래스였음 </p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// 글자 길이로 정렬하는 함수 객체
</span><span style=color:#75715e></span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>words<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Comparator<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;()</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>String s1<span style=color:#f92672>,</span> String s2<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> Integer<span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>s1<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>(),</span> s2<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>());</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>})</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// java8 부터
</span><span style=color:#75715e></span>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>words<span style=color:#f92672>,</span>
    <span style=color:#f92672>(</span>s1<span style=color:#f92672>,</span>s 2<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> Integer<span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>s1<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>(),</span> s2<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()));</span>
</code></pre></div><h3 id=람다의-특징>
람다의 특징
<a class=anchor href=#%eb%9e%8c%eb%8b%a4%ec%9d%98-%ed%8a%b9%ec%a7%95>#</a>
</h3>
<ul>
<li>lambda의 타입(Comparator)</li>
<li>parameter (String s1, String s2)</li>
<li>return value (int)
코드에 표시 안됨. 컴파일러가 컨텍스트를 보고 다 추론함. 특정 경우는 컴파일러가 추론 못하고 프로그래머가 타입을 지정해야 할 수도 있음.
추론 규칙을 자세히 이해하기는 어려운데, 일단 가능한 한 다 생략해버려도 된다.</li>
</ul>
<p>컴파일러가 추론할 때 Generic을 많이 이용하기 때문에 잘 쓰는게 좋다.
위 예제에서 words 가 List 아니라 List 로 선언 되었으면 컴파일 되지 않는다.</p>
<p>Comparator 가 제공하는 snippet 메서드를 이용하면 더 짧게 할 수 있다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>Collections<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>words<span style=color:#f92672>,</span> comparingInt<span style=color:#f92672>(</span>String<span style=color:#f92672>::</span>length<span style=color:#f92672>));</span>
</code></pre></div><p>java8 부터 List에 추가된 메소드를 이용하면 더 줄 일 수 있다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>words<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>comparingInt<span style=color:#f92672>(</span>String<span style=color:#f92672>::</span>length<span style=color:#f92672>));</span>
</code></pre></div><p>앞서 enum type 에 나왔던 Operation을 람다로 리팩토링하면 다음과 같다</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// lambdas 적용 전
</span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Operation <span style=color:#f92672>{</span>
    PLUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;+&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> x <span style=color:#f92672>+</span> y<span style=color:#f92672>;}</span>
    <span style=color:#f92672>},</span>
    MINUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;-&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> x <span style=color:#f92672>-</span> y<span style=color:#f92672>;}</span>
    <span style=color:#f92672>},</span>
    TIMES<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;*&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> x <span style=color:#f92672>*</span> y<span style=color:#f92672>;}</span>
    <span style=color:#f92672>},</span>
    DIVIDE<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>return</span> x <span style=color:#f92672>/</span> y<span style=color:#f92672>;}</span>
    <span style=color:#f92672>};</span>

    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String symbol<span style=color:#f92672>;</span>
    Operation<span style=color:#f92672>(</span>STring sysmbol<span style=color:#f92672>)</span> <span style=color:#f92672>{</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>symbol</span> <span style=color:#f92672>=</span> symbol<span style=color:#f92672>;}</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> Operation <span style=color:#f92672>{</span>
    PLUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;+&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>+</span> y<span style=color:#f92672>),</span>
    MINUS<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;-&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>-</span> y<span style=color:#f92672>),</span>
    TIMES<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;*&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>*</span> y<span style=color:#f92672>),</span>
    DIVIDE<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> x <span style=color:#f92672>/</span> y<span style=color:#f92672>);</span>

    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String symbol<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> DoubleBinaryOperator op<span style=color:#f92672>;</span>

    Operation<span style=color:#f92672>(</span>String symbol<span style=color:#f92672>,</span> DoubleBinaryOperator op<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>symbol</span> <span style=color:#f92672>=</span> symbol<span style=color:#f92672>;</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>op</span> <span style=color:#f92672>=</span> op<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> <span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span><span style=color:#66d9ef>double</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>double</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> op<span style=color:#f92672>.</span><span style=color:#a6e22e>applyAsDouble</span><span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p><code>DoubleBinaryOperator</code> 는 java.util.function에 정의된 함수형 인터페이스 중 하나. 2개의 double을 인자로 받아서 하나의 double을 반환한다.</p>
<h3 id=주의할-점>
주의할 점
<a class=anchor href=#%ec%a3%bc%ec%9d%98%ed%95%a0-%ec%a0%90>#</a>
</h3>
<p>람다는 이름과 설명이 없기 때문에 코드가 그 내용을 설명해주지 못하거나 또는 두 세 줄이 넘어가면 안쓰는 게 좋다.
한 줄이 이상적이고 최대 3줄이 허용범위임.</p>
<h3 id=익명-클래스가-람다보다-좋은-점>
익명 클래스가 람다보다 좋은 점
<a class=anchor href=#%ec%9d%b5%eb%aa%85-%ed%81%b4%eb%9e%98%ec%8a%a4%ea%b0%80-%eb%9e%8c%eb%8b%a4%eb%b3%b4%eb%8b%a4-%ec%a2%8b%ec%9d%80-%ec%a0%90>#</a>
</h3>
<ul>
<li>
<p>객체를 생성할 수 있다??(lambda는 객체가 아닌가?)</p>
</li>
<li>
<p>여러 추상 메소드가 있는 경우에도 쓸 수 있다</p>
</li>
<li>
<p>람다는 자기 자신의 참조를 얻을 수 없다 (lambda 에서 this 는 감싸고 있는 instance 를 의미. 익명 클래스는 클래스 자기 자신을 의미)</p>
</li>
<li>
<p>람다와 익명클래스 둘 다 직렬화 역직렬화 믿을 수 없음. (JVM 따라 달라서 인 듯)</p>
</li>
<li>
<p>가급적 람다와 익명 클래스 직렬화 하지 말 것.</p>
</li>
<li>
<p>정말 하고 싶으면 private static nested class의 객체를 이용할 것 (Comparator 처럼)</p>
</li>
</ul>
<h3 id=요약>
요약
<a class=anchor href=#%ec%9a%94%ec%95%bd>#</a>
</h3>
<ul>
<li>람다는 함수 객체를 이용하는 최고의 방법</li>
<li>진짜 클래스 객체가 필요하지 않으면 익명 클래스보단 람다 쓰자</li>
<li>람다 쓰면 함수형 프로그래밍 입문 하는 거다 어서 쓰자</li>
</ul>
<h2 id=규칙-43-람다보다-메소드-참조를-쓰자>
규칙 43 람다보다 메소드 참조를 쓰자
<a class=anchor href=#%ea%b7%9c%ec%b9%99-43-%eb%9e%8c%eb%8b%a4%eb%b3%b4%eb%8b%a4-%eb%a9%94%ec%86%8c%eb%93%9c-%ec%b0%b8%ec%a1%b0%eb%a5%bc-%ec%93%b0%ec%9e%90>#</a>
</h2>
<p>람다의 장점은 간결함임. 자바는 람다보다 더 간견한 방식을 추가함: <code>method reference</code></p>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#규칙-42-익명-클래스-보다-람다를-쓰자>규칙 42 익명 클래스 보다 람다를 쓰자</a>
<ul>
<li><a href=#람다의-특징>람다의 특징</a></li>
<li><a href=#주의할-점>주의할 점</a></li>
<li><a href=#익명-클래스가-람다보다-좋은-점>익명 클래스가 람다보다 좋은 점</a></li>
<li><a href=#요약>요약</a></li>
</ul>
</li>
<li><a href=#규칙-43-람다보다-메소드-참조를-쓰자>규칙 43 람다보다 메소드 참조를 쓰자</a></li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>