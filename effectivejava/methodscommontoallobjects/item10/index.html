<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="자바 잘 짜보자">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="Effective Java">
<meta property="og:description" content="자바 잘 짜보자">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sangmoon.github.io/TIL/effectivejava/methodscommontoallobjects/item10/"><meta property="article:section" content="EffectiveJava">
<meta property="article:published_time" content="2021-10-23T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-23T00:00:00+00:00">
<title>Effective Java | Sangmoon's TIL</title>
<link rel=manifest href=/TIL/manifest.json>
<link rel=icon href=/TIL/favicon.png type=image/x-icon>
<link rel=stylesheet href=/TIL/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous>
<script defer src=/TIL/flexsearch.min.js></script>
<script defer src=/TIL/en.search.min.58e317a58bdb983ff9fe64dbce44994883782a83ea5a5d5fbf080e12279c4e0f.js integrity="sha256-WOMXpYvbmD/5/mTbzkSZSIN4KoPqWl1fvwgOEiecTg8=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/TIL/><span>Sangmoon's TIL</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/TIL/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Effective Java</strong>
<label for=toc-control>
<img src=/TIL/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#item-10-obey-the-general-contract-when-overriding-equals>Item 10: Obey the general contract when overriding equals</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h2 id=item-10-obey-the-general-contract-when-overriding-equals>
Item 10: Obey the general contract when overriding equals
<a class=anchor href=#item-10-obey-the-general-contract-when-overriding-equals>#</a>
</h2>
<p><code>equals</code>를 구현하는 건 쉽지 않다. 가장 쉬운 방법은 override 하지 않는 것이다.
다음 조건 중 하나라도 만족하면 구현하지 않는 것이 좋다.</p>
<ol>
<li>Each instance of the class is inherently unique. <code>Thread</code>와 같은 객체는 값보다 엔티티 자체를 표현한다. Object에서 제공하는 equals로 충분하다</li>
<li>There is no need for he class to provide a <code>logical equality</code> test. Client가 해당 기능을 필요하지 않다고 생각한다면 굳이 구현할 필요가 없다.</li>
<li>A superclass has already overridden equals, and the superclass behavior is appropriate for this class. 예를 들어 Set은 AbstractSet, List 는 AbstractList, Map은 AbstractMap에서 미리 구현했다.</li>
<li>The class is private or package-private and your are certain that its equals method will never be invoked. 정말 위험을 감수하기 싫으면 다음과 같이 처리할 수도 있다.</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> AssertionError<span style=color:#f92672>();</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>정말 equlas 를 override 하고 싶으면 일반 규칙을 준수해야 한다. 다음과 같다.</p>
<ul>
<li><code>Reflexive</code>: for any Non-null reference value x, x.equals(x) must return true</li>
<li><code>Symmetric</code>: for any non-null reference values x and y, x.equals(y) == y.equals(x)</li>
<li><code>Transitive</code>: for any non-null reference values x,y,z, if x.equals(y) == true and y.equals(z) == true then x.equals(z) must return true</li>
<li><code>Consistent</code>: equals가 여러번 불려도 x, y 가 변경되지 않았다면 항상 같은 값을 return 해야 한다.</li>
<li>x.equals(null) must return false</li>
</ul>
<p>&mldr; 갑자기 이산수학이.. 하나씩 살펴보자</p>
<ul>
<li><code>Reflexivity</code> 이건 객체는 자기 자신과 항상 같아야 함을 뜻한다. 이걸 위반하는게 더 힘든데, 이 어려운 걸 해낸다면 collection에서 자기 자신을 찾을 수 없을 것이다.</li>
<li><code>Symmetry</code> 는 두 객체의 equals 값이 항상 같아야 한다는 것이다. 다음과 같이 만들면 위반할 수 있다.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// violate sysmmetry
</span><span style=color:#75715e></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CaseInsensitiveString</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String s<span style=color:#f92672>;</span>

    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CaseInsensitiveString</span><span style=color:#f92672>(</span>String s<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>s</span> <span style=color:#f92672>=</span> Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
    <span style=color:#f92672>}</span>

    <span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>o <span style=color:#66d9ef>instanceof</span> CaseInsensitiveString<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>equalsInnoreCase</span><span style=color:#f92672>(</span>
                <span style=color:#f92672>((</span>CaseInsensitiveString<span style=color:#f92672>)</span>o<span style=color:#f92672>).</span><span style=color:#a6e22e>s</span>
            <span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>o <span style=color:#66d9ef>instanceof</span> String<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> s<span style=color:#f92672>.</span><span style=color:#a6e22e>equalsIgnoreCase</span><span style=color:#f92672>(</span>String o<span style=color:#f92672>);</span> <span style=color:#75715e>// one-way interoperability!
</span><span style=color:#75715e></span>        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>위의 경우 CaseInsensitiveString.equals(String s) 는 true 가 나올수 있지만 String.equals(CaseInsensitiveString cis) 는 항상 false가 나오게 된다.
이렇게 되면 이 객체의 행동을 예측할 수 없게 된다.
따라서 String과 통합하려는 시도는&mldr; 멍청하다고 할 수 있다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// 그냥 String 통합은 포기!
</span><span style=color:#75715e></span><span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>return</span> o <span style=color:#66d9ef>instanceof</span> CaseInsensitiveString <span style=color:#f92672>&amp;&amp;</span> 
    s<span style=color:#f92672>.</span><span style=color:#a6e22e>equalsInnoreCase</span><span style=color:#f92672>(((</span>CaseInsensitiveString<span style=color:#f92672>)</span>o<span style=color:#f92672>).</span><span style=color:#a6e22e>s</span><span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><ul>
<li><code>Transitivity</code> 이건 a와 b가 같고 b와 c 가 같으면 a와 c 가 같아야 함을 말한다. 위반하는걸 상상하기 어려운데&mldr; subclass가 equals에 영항을 주는 추가 정보를 담는 경우를 생각해보자.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Point</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> x<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>;</span>

    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Point</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> x<span style=color:#f92672>;</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> y<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span><span style=color:#f92672>(!(</span>o <span style=color:#66d9ef>instanceof</span> Point<span style=color:#f92672>))</span>
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
        Point p <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Point<span style=color:#f92672>)</span>o<span style=color:#f92672>;</span>
        <span style=color:#66d9ef>return</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>x</span> <span style=color:#f92672>==</span> x <span style=color:#f92672>&amp;&amp;</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> y<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ColorPoint</span> <span style=color:#66d9ef>extends</span> Point <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Color color<span style=color:#f92672>;</span>

    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ColorPoint</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>,</span> Color color<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>super</span><span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> color<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>이 상태로 두면 ColorPoint는 부모인 Point의 equals를 사용하게 된다. 당연히 color 정보는 무시되고, 이걸 의도하진 않았겠으니 override 해야 할 거다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// violates symmetry
</span><span style=color:#75715e></span><span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span><span style=color:#f92672>(!(</span>o <span style=color:#66d9ef>instanceof</span> ColorPoint<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>super</span><span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>o<span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>((</span>ColorPoint<span style=color:#f92672>)</span>o<span style=color:#f92672>).</span><span style=color:#a6e22e>color</span> <span style=color:#f92672>==</span> color<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>문제는 Point와 ColorPoint를 비교할 때 생긴다. 전자는 color를 무시하고 비교하지만
후자는 항상 false가 나오기 때문이다. 따라서 symmetry 를 위반한다. 그래서 만약 다음과 같이 바꾼다면</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// violates transivity
</span><span style=color:#75715e></span><span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span><span style=color:#f92672>(!(</span>o <span style=color:#66d9ef>instanceof</span> Point<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
    
    <span style=color:#75715e>// o is norla Point
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span><span style=color:#f92672>(!(</span>o <span style=color:#66d9ef>instanceof</span> ColorPoint<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> o<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>// o is ColorPoint
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>super</span><span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>o<span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>((</span>ColorPoint<span style=color:#f92672>)</span>o<span style=color:#f92672>).</span><span style=color:#a6e22e>color</span> <span style=color:#f92672>==</span> color<span style=color:#f92672>;</span>

<span style=color:#f92672>}</span>
</code></pre></div><p>이러면 sysmmetry는 해결되지만, transitivity에서 문제가 생긴다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#75715e>// what if?
</span><span style=color:#75715e></span>ColorPoint p1 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ColorPoint<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>RED</span><span style=color:#f92672>);</span>
Point p2 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 2<span style=color:#f92672>);</span>
ColorPoint p3 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ColorPoint<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>BLUE</span><span style=color:#f92672>);</span>

p1<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>p2<span style=color:#f92672>)</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>
p2<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>p3<span style=color:#f92672>)</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>
p1<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>p3<span style=color:#f92672>)</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>
</code></pre></div><p>왜냐하면 Point는 color를 무시하기 때문에 이런 결과가 나온다. 또한 다른 subclass가 있다고 한다면 무한 recursion에 빠질 수 있다.</p>
<p><code>getClass</code>를 사용해서 해결할 수 있다는 사람들도 있다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>o <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>||</span> o<span style=color:#f92672>.</span><span style=color:#a6e22e>getClass</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> getClass<span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
    Point p <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Point<span style=color:#f92672>)</span> o<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>return</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>x</span> <span style=color:#f92672>==</span> x <span style=color:#f92672>&amp;&amp;</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>y</span> <span style=color:#f92672>==</span> y<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>같은 클래스여야만 equals를 확인한다. 그럴듯해보이지만 결과는 그렇지 않다. 상속을 완전 무시하는 결과이다. 따라서 지양해야하는 방향이다.</p>
<p>그럼 해결책은 무엇일까? 이건 객체지향 언어의 근본적인 동일성 문제이다. equals를 깨지 않으면서 클래스를 상속받아 값을 추가할 방법은 없다.</p>
<p>상속을 통한 방법은 없지만, 좋은 방법이 있다, <code>Item 18: 상속보단 구성!</code>
ColorPoint가 Point를 상속하는 대신 필드를 갖게하고 view 메소드를 주는 것이다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ColorPoint</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Point point<span style=color:#f92672>;</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> Color color<span style=color:#f92672>;</span>

    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ColorPoint</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> y<span style=color:#f92672>,</span> Color color<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        point <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>requireNonNull</span><span style=color:#f92672>(</span>color<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>

    <span style=color:#66d9ef>public</span> Point <span style=color:#a6e22e>asPoint</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> point<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#a6e22e>@Override</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Object o<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span><span style=color:#f92672>(!(</span>o <span style=color:#66d9ef>instanceof</span> ColorPoint<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span>
        ColorPoint cp <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>ColorPoint<span style=color:#f92672>)</span>o<span style=color:#f92672>;</span>
        <span style=color:#66d9ef>return</span> cp<span style=color:#f92672>.</span><span style=color:#a6e22e>point</span><span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>point<span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> cp<span style=color:#f92672>.</span><span style=color:#a6e22e>color</span><span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>color<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><ul>
<li><code>Non-nullity</code>: <code>instanceof</code> keyword 가 인자가 null로 들어오면 false를 return하기 때문에 굳이 null check를 별도로 할 필요는 없다.</li>
</ul>
<p>결론적으로 수준높은 equals를 짜기 위해 다음 과정이 필요하다.</p>
<ol>
<li>Use the == operator to check if the argument is a reference to this object. 최적화를 위한 것</li>
<li>Use the instanceof operator to check if the argument has the correct type. interface 가 있다면 interface를 이용해라(Collection)</li>
<li>Cast the argument to the correct type</li>
<li>For each <code>significant</code> field in the class, check if that field of the argument matches the corresponding field of this object</li>
</ol>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#item-10-obey-the-general-contract-when-overriding-equals>Item 10: Obey the general contract when overriding equals</a></li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>