<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Sangmoon's TIL</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="Item 14: Consider implementing Comparable Comparable은 Object에 정의된 인터페이스가 아니고, 단독 인터페이스이다. equals와 비슷한데 순서를 정하게 해준다. Comparable을 구현한 객체 배열은 다음과 같이 정렬할 수 있다.
Arrays.sort(a); 기본적으로 java에서 값을 나타내는 클래스는 Comparable을 구현한다. 만약 알파벳 순서나, 수치 순서, 연대 순 등과 같은 natural ordering이 필요하다면 반드시 Comparable 인터페이스를 구현해야 한다.
public interface Comparable<T> { int compareTo(T t); } compareTo의 일반적인 규약은 equals와 비슷하다.
 이 객체가 비교하고자 하는 녀석보다 작으면 음수를 반환, 같으면 0을 반환 크면 양수를 반환한다.">
<meta name=generator content="Hugo 0.88.1">
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel=stylesheet href=/TIL/ananke/css/main.min.css>
<meta property="og:title" content>
<meta property="og:description" content="Item 14: Consider implementing Comparable Comparable은 Object에 정의된 인터페이스가 아니고, 단독 인터페이스이다. equals와 비슷한데 순서를 정하게 해준다. Comparable을 구현한 객체 배열은 다음과 같이 정렬할 수 있다.
Arrays.sort(a); 기본적으로 java에서 값을 나타내는 클래스는 Comparable을 구현한다. 만약 알파벳 순서나, 수치 순서, 연대 순 등과 같은 natural ordering이 필요하다면 반드시 Comparable 인터페이스를 구현해야 한다.
public interface Comparable<T> { int compareTo(T t); } compareTo의 일반적인 규약은 equals와 비슷하다.
 이 객체가 비교하고자 하는 녀석보다 작으면 음수를 반환, 같으면 0을 반환 크면 양수를 반환한다.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sangmoon.github.io/TIL/posts/effectivejava/methodscommontoallobjects/item14/"><meta property="article:section" content="posts">
<meta itemprop=name content>
<meta itemprop=description content="Item 14: Consider implementing Comparable Comparable은 Object에 정의된 인터페이스가 아니고, 단독 인터페이스이다. equals와 비슷한데 순서를 정하게 해준다. Comparable을 구현한 객체 배열은 다음과 같이 정렬할 수 있다.
Arrays.sort(a); 기본적으로 java에서 값을 나타내는 클래스는 Comparable을 구현한다. 만약 알파벳 순서나, 수치 순서, 연대 순 등과 같은 natural ordering이 필요하다면 반드시 Comparable 인터페이스를 구현해야 한다.
public interface Comparable<T> { int compareTo(T t); } compareTo의 일반적인 규약은 equals와 비슷하다.
 이 객체가 비교하고자 하는 녀석보다 작으면 음수를 반환, 같으면 0을 반환 크면 양수를 반환한다.">
<meta itemprop=wordCount content="381">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content>
<meta name=twitter:description content="Item 14: Consider implementing Comparable Comparable은 Object에 정의된 인터페이스가 아니고, 단독 인터페이스이다. equals와 비슷한데 순서를 정하게 해준다. Comparable을 구현한 객체 배열은 다음과 같이 정렬할 수 있다.
Arrays.sort(a); 기본적으로 java에서 값을 나타내는 클래스는 Comparable을 구현한다. 만약 알파벳 순서나, 수치 순서, 연대 순 등과 같은 natural ordering이 필요하다면 반드시 Comparable 인터페이스를 구현해야 한다.
public interface Comparable<T> { int compareTo(T t); } compareTo의 일반적인 규약은 equals와 비슷하다.
 이 객체가 비교하고자 하는 녀석보다 작으면 음수를 반환, 같으면 0을 반환 크면 양수를 반환한다.">
</head>
<body class="ma0 avenir bg-near-white">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/TIL/ class="f3 fw2 hover-white no-underline white-90 dib">
Sangmoon's TIL
</a>
<div class="flex-l items-center">
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://sangmoon.github.io/TIL/posts/effectivejava/methodscommontoallobjects/item14/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://sangmoon.github.io/TIL/posts/effectivejava/methodscommontoallobjects/item14/&text=" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://sangmoon.github.io/TIL/posts/effectivejava/methodscommontoallobjects/item14/&title=" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1"></h1>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h2 id=item-14-consider-implementing-comparable>Item 14: Consider implementing Comparable</h2>
<p>Comparable은 Object에 정의된 인터페이스가 아니고, 단독 인터페이스이다. equals와 비슷한데 순서를 정하게 해준다.
Comparable을 구현한 객체 배열은 다음과 같이 정렬할 수 있다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>sort</span><span style=color:#f92672>(</span>a<span style=color:#f92672>);</span>
</code></pre></div><p>기본적으로 java에서 값을 나타내는 클래스는 Comparable을 구현한다. 만약 알파벳 순서나, 수치 순서, 연대 순 등과 같은 natural ordering이 필요하다면
반드시 <code>Comparable</code> 인터페이스를 구현해야 한다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Comparable</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>T t<span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>compareTo의 일반적인 규약은 equals와 비슷하다.</p>
<blockquote>
<p>이 객체가 비교하고자 하는 녀석보다 작으면 음수를 반환,
같으면 0을 반환
크면 양수를 반환한다.
비교할 수 없는 녀석이면 <code>ClassCastException</code> 을 반환한다.</p>
</blockquote>
<ul>
<li>sgn() 은 signum function을 의미한다.</li>
<li>sgn(x.compareTo(y)) == -sgn(y.compareTo(x)) for all x and y(이건 x.compareTo(y) 가 exception 나오면 y.compareTo(x) 도 exception 을 반환해야 한다는 것을 의미한다)</li>
<li><code>transitive</code> 함을 보장해야 한다.(x.compareTo(y) > 0 && y.compareTo(z) > 0 이면 x.compareTo(z) > 0 이여야 한다.)</li>
<li>x.compareTo(y) == 0 이면 sgn(x.compare(z)) == sgn(y.compare(z)) 여야 한다.</li>
<li>(x.compareTo(y) == 0) == (x.equals(y)) 는 강제는 아니지만 정말 추천한다. Comparable을 구현하면서 이 규약을 위반하는 경우 분명히 명시해야 한다. &ldquo;이 클래스는 equals와 대치되는 순서를 갖고 있습니다.&rdquo;</li>
</ul>
<p>보면 equals와 굉장히 닮아 있다, <code>reflexivity</code> <code>symmetry</code> <code>transitivity</code> 모두를 만족해야 한다. 따라서 같은 문제가 있다. 기존 compareTo 규약을 유지하면서 상속을 통해 확장할 방법이 없다. Comparable을 구현한 클래스에 값을 추가하고 싶다면 상속하지 마라. 구성을 통해 필드로 해당 객체를 사용하는 것이 유일한 방법이다.</p>
<p>마지막 규약은 compareTo의 equality 판단 값이 equals의 판단과 같아야 한다는 것이다.
둘이 다르면 일관성이 깨졌다고 표현하고, 동작은 하겠지만 Collection, Set, Map 에서 생각대로 동작하지 않을 수 있다. 왜냐하면 이런 인터페이스들은 equals 를 이용해 보통 정의되지만, sorted algorithm은 보통 compareTo를 이용하기 때문이다. 큰 재앙은 아니지만 주의해야 한다.</p>
<p>compareTo method에서는 필드를 비교하면 되는데 객체의 경우 recursive하게 compareTo를 불러주면 된다. 만약 객체가 Comparable을 상속하지 안았다면 Comparator를 대신 써라.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CaseInsensitiveString</span> <span style=color:#66d9ef>implements</span> Comparable<span style=color:#f92672>&lt;</span>CaseInsensitiveString<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>CaseInsensitiveString cis<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>return</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>CASE_INSENSITIVE_ORDER</span><span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>s<span style=color:#f92672>,</span> cis<span style=color:#f92672>.</span><span style=color:#a6e22e>s</span><span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>이전 버전의 책에서는 비교에서 부등흐를 사용했는데 java6부터 static compare methods들이 모든 boxed primitive type에 추가되었다. 부등호 쓰지말고 static method 사용하자.</p>
<p>만약 중요한 필드가 여러개라면 비교하는 순서가 중요해진다. 가장 중요한 필드부터 차례대로 비교하고, 0이 아닌 값이 나오면 그 순간에 반환하면 된다.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>compareTo</span><span style=color:#f92672>(</span>PhoneNumber pn<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>int</span> result <span style=color:#f92672>=</span> Short<span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>areaCode<span style=color:#f92672>,</span> pn<span style=color:#f92672>.</span><span style=color:#a6e22e>areaCode</span><span style=color:#f92672>);</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>result <span style=color:#f92672>==</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        result <span style=color:#f92672>=</span> Short<span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>prefix<span style=color:#f92672>,</span> pn<span style=color:#f92672>.</span><span style=color:#a6e22e>prefix</span><span style=color:#f92672>);</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>result <span style=color:#f92672>==</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            result <span style=color:#f92672>=</span> Short<span style=color:#f92672>.</span><span style=color:#a6e22e>compare</span><span style=color:#f92672>(</span>lineNum<span style=color:#f92672>,</span> pn<span style=color:#f92672>.</span><span style=color:#a6e22e>lineNum</span><span style=color:#f92672>);</span>
        <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>
    <span style=color:#66d9ef>return</span> result<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>요약하면 값을 비교해야할 필요가 있을 땐 Comparable을 구현해서 쉽게 정렬하고 검색할 수 있게 해라. 부등호 사용은 피하고 static method를 사용하거나 Comparator를 구현한 Comparator를 이용해라.</p>
<ul class=pa0>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://sangmoon.github.io/TIL>
&copy; Sangmoon's TIL 2021
</a>
<div>
</div>
</div>
</footer>
</body>
</html>